<!-- wp:heading {"level":1} -->
<h1>MCP Governance: AI-Powered Kubernetes-Native Security for Model Context Protocol Infrastructure</h1>
<!-- /wp:heading -->

<!-- wp:heading {"level":2} -->
<h2>Introduction</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The Model Context Protocol (MCP) is transforming how AI agents interact with tools and data. By exposing MCP servers across your Kubernetes clusters, you unlock powerful AI capabilities ‚Äî but without proper governance, you're exposed to critical security risks.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Imagine this scenario: An AI agent with access to an unprotected MCP server that exposes 50+ tools. A prompt injection attack tricks the agent into executing an unauthorized database dump tool, exfiltrating sensitive customer data. No authentication layer stops it. No rate limiting prevents the runaway loop. No audit trail captures what happened.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>MCP Governance (MCP-G)</strong> solves this problem by providing enterprise-grade security and compliance for MCP infrastructure in Kubernetes. It's an AI-powered governance platform that discovers, evaluates, and secures all MCP-related resources in your cluster.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In this deep-dive, we'll explore how MCP-G works, why it matters, and how to deploy it to your Kubernetes cluster.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2>The Problem: Unsecured MCP Servers in Kubernetes</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Why MCP Governance Matters</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>As AI agents become mainstream, organizations are deploying MCP servers across Kubernetes clusters to expose tools, databases, and APIs. However, this creates unprecedented security challenges:</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4>1. Zero Visibility</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>How many MCP servers are running in your cluster?</li>
<li>Which agents have access to which tools?</li>
<li>Are there unprotected servers exposed directly to the internet?</li>
<li>Without discovery and inventory, you can't govern what you can't see.</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":4} -->
<h4>2. Unconstrained Access</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>MCP servers often expose 50+ tools without restrictions</li>
<li>A compromised agent or prompt injection attack can invoke any tool</li>
<li>No principle of least privilege ‚Äî agents get "all or nothing"</li>
<li>Without authorization controls, blast radius grows exponentially</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":4} -->
<h4>3. Prompt Injection Vulnerability</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>AI agents are susceptible to prompt injection attacks that trick them into executing unauthorized actions</li>
<li>Malicious inputs can manipulate tool calls, triggering sensitive operations</li>
<li>Sensitive data in tool responses (SSNs, credit cards, API keys) can be leaked to the AI model</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":4} -->
<h4>4. No Audit Trail</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Who called which tools? When? From which agent?</li>
<li>Without logging and monitoring, compliance and forensics are impossible</li>
<li>Incident response becomes guesswork</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":4} -->
<h4>5. Configuration Drift</h4>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Security policies are defined in policy documents, not code</li>
<li>Clusters drift from intended security posture over time</li>
<li>No enforcement mechanism ensures policies are continuously applied</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>The Solution: MCP Governance (MCP-G)</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>MCP Governance is a Kubernetes-native platform that:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol>
<li><strong>Discovers</strong> all MCP-related resources in your cluster automatically</li>
<li><strong>Correlates</strong> resources into MCP-server-centric views</li>
<li><strong>Evaluates</strong> security posture across 8 governance categories</li>
<li><strong>Scores</strong> cluster compliance on a 0‚Äì100 scale</li>
<li><strong>Analyzes</strong> risks with AI agents (optional: Google Gemini or Ollama)</li>
<li><strong>Surfaces</strong> findings in a real-time enterprise dashboard</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Architecture: How MCP-G Works</h2>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 500'%3E%3Crect width='700' height='500' fill='%23f5f5f5'/%3E%3Ctext x='350' y='25' font-size='16' font-weight='bold' text-anchor='middle'%3EKubernetes Cluster%3C/text%3E%3Crect x='50' y='60' width='250' height='80' fill='%236366f1' stroke='%234f46e5' stroke-width='2'/%3E%3Ctext x='175' y='85' font-size='14' font-weight='bold' fill='white' text-anchor='middle'%3Eüñ•Ô∏è Dashboard%3C/text%3E%3Ctext x='175' y='105' font-size='12' fill='white' text-anchor='middle'%3ENext.js :3000%3C/text%3E%3Ctext x='175' y='125' font-size='11' fill='white' text-anchor='middle'%3E(every 15s)%3C/text%3E%3Crect x='400' y='60' width='250' height='120' fill='%230ea5e9' stroke='%230284c7' stroke-width='2'/%3E%3Ctext x='525' y='80' font-size='14' font-weight='bold' fill='white' text-anchor='middle'%3E‚öôÔ∏è Governance Controller%3C/text%3E%3Ctext x='525' y='100' font-size='11' fill='white' text-anchor='middle'%3E‚Ä¢ Go API Server :8090%3C/text%3E%3Ctext x='525' y='115' font-size='11' fill='white' text-anchor='middle'%3E‚Ä¢ Scoring Engine%3C/text%3E%3Ctext x='525' y='130' font-size='11' fill='white' text-anchor='middle'%3E‚Ä¢ AI Agent%3C/text%3E%3Ctext x='525' y='145' font-size='11' fill='white' text-anchor='middle'%3E‚Ä¢ Resource Discovery%3C/text%3E%3Crect x='100' y='220' width='500' height='140' fill='%23f9fafb' stroke='%2394a3b8' stroke-width='2'/%3E%3Ctext x='350' y='240' font-size='13' font-weight='bold' text-anchor='middle'%3Eüì¶ Discovered Resources%3C/text%3E%3Crect x='120' y='260' width='110' height='70' fill='%23f59e0b' stroke='%23d97706' stroke-width='1'/%3E%3Ctext x='175' y='280' font-size='11' font-weight='bold' text-anchor='middle'%3Eüõ°Ô∏è AgentGateway%3C/text%3E%3Ctext x='175' y='295' font-size='9' text-anchor='middle'%3E‚Ä¢ Backend%3C/text%3E%3Ctext x='175' y='307' font-size='9' text-anchor='middle'%3E‚Ä¢ Policy%3C/text%3E%3Crect x='255' y='260' width='110' height='70' fill='%2310b981' stroke='%23059669' stroke-width='1'/%3E%3Ctext x='310' y='280' font-size='11' font-weight='bold' text-anchor='middle'%3Eü§ñ Kagent%3C/text%3E%3Ctext x='310' y='295' font-size='9' text-anchor='middle'%3E‚Ä¢ Agent%3C/text%3E%3Ctext x='310' y='307' font-size='9' text-anchor='middle'%3E‚Ä¢ MCPServer%3C/text%3E%3Crect x='390' y='260' width='110' height='70' fill='%238b5cf6' stroke='%237c3aed' stroke-width='1'/%3E%3Ctext x='445' y='280' font-size='11' font-weight='bold' text-anchor='middle'%3Eüåê Gateway API%3C/text%3E%3Ctext x='445' y='295' font-size='9' text-anchor='middle'%3E‚Ä¢ Gateway%3C/text%3E%3Ctext x='445' y='307' font-size='9' text-anchor='middle'%3E‚Ä¢ HTTPRoute%3C/text%3E%3Crect x='525' y='260' width='60' height='70' fill='%23ef4444' stroke='%23dc2626' stroke-width='1'/%3E%3Ctext x='555' y='280' font-size='10' font-weight='bold' text-anchor='middle'%3Eüìã Gov%3C/text%3E%3Crect x='100' y='410' width='150' height='70' fill='%23ec4899' stroke='%23db2777' stroke-width='2'/%3E%3Ctext x='175' y='430' font-size='12' font-weight='bold' fill='white' text-anchor='middle'%3Eüåê LLM Provider%3C/text%3E%3Ctext x='175' y='450' font-size='10' fill='white' text-anchor='middle'%3E‚Ä¢ Google Gemini%3C/text%3E%3Ctext x='175' y='465' font-size='10' fill='white' text-anchor='middle'%3E‚Ä¢ Ollama%3C/text%3E%3C/svg%3E" alt="MCP-G Architecture Diagram" /></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3>Data Flow</h3>
<!-- /wp:heading -->

<!-- wp:list {"ordered":true} -->
<ol>
<li><strong>Discovery (Every 30 seconds)</strong> - Controller uses Kubernetes API to list all relevant resources and builds an MCP-server-centric inventory</li>
<li><strong>Policy Reading</strong> - Controller reads <code>MCPGovernancePolicy</code> CRD to determine scoring thresholds and enforcement rules</li>
<li><strong>Evaluation</strong> - Evaluator scores each MCP server across 8 governance categories and generates findings</li>
<li><strong>AI Analysis (Optional)</strong> - If enabled, sends cluster state to LLM for deeper risk analysis and remediation suggestions</li>
<li><strong>API &amp; Status Update</strong> - Results exposed via REST API and <code>GovernanceEvaluation</code> CRD updated with scoring details</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Scoring System: 8 Governance Categories</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>MCP-G evaluates security across 8 distinct categories, each with specific pass/fail criteria:</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>1. Gateway Routing (20 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is the MCP server routed through AgentGateway?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> Server exposed through governed gateway ‚Üí +20 points</li>
<li><strong>Fail:</strong> Direct exposure without gateway layer ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Without a gateway, there's no central enforcement point. Any tool call reaches the server unfiltered.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>2. Authentication (20 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is JWT or mutual-TLS authentication enforced?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> JWT Strict mode enforced on the route ‚Üí +20 points</li>
<li><strong>Partial:</strong> JWT present but permissive mode ‚Üí +10 points</li>
<li><strong>Fail:</strong> No authentication required ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Unauthenticated MCP servers let any agent or script invoke tools without identity verification.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>3. Authorization (15 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Are tool calls filtered by an allow-list policy?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> Tool allow-list enforced via AgentgatewayPolicy ‚Üí +15 points</li>
<li><strong>Fail:</strong> All tools exposed with no filter ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Even authenticated agents should only access tools they need (principle of least privilege).</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>4. TLS Encryption (15 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is TLS configured on backend connections?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> TLS with SNI verification enabled ‚Üí +15 points</li>
<li><strong>Fail:</strong> Plaintext backend connection ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Without TLS, tool payloads can be intercepted in transit inside the cluster.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>5. CORS Policy (10 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is CORS configured to restrict cross-origin access?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> CORS policy restricts allowed origins ‚Üí +10 points</li>
<li><strong>Partial:</strong> CORS configured via policy ‚Üí +8 points</li>
<li><strong>Fail:</strong> No CORS policy, all origins allowed ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Without CORS, browser-based clients can be tricked into making unauthorized tool calls from malicious origins.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>6. Rate Limiting (10 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is rate limiting applied to prevent abuse?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> Rate limit policy applied ‚Üí +10 points</li>
<li><strong>Fail:</strong> No rate limit, unlimited calls allowed ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Agents in a runaway loop can make thousands of calls in seconds, causing disruption or data exfiltration.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>7. Prompt Guard (10 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> Is AI prompt injection protection enabled?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> Prompt guard with injection detection + data masking ‚Üí +10 points</li>
<li><strong>Partial:</strong> Partial guard (request or response only) ‚Üí +5 points</li>
<li><strong>Fail:</strong> No prompt protection ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Prompt injection attacks trick AI agents into unauthorized actions. Sensitive data in responses must be masked.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>8. Tool Scope (10 points)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>The Question:</strong> How tightly is the exposed tool surface restricted?</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li><strong>Pass:</strong> ‚â§25% of tools exposed (maximum restriction) ‚Üí +10 points</li>
<li><strong>Graduated:</strong> Sliding scale based on exposure percentage</li>
<li><strong>Fail:</strong> 100% of tools exposed (no restriction) ‚Üí 0 points</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Why It Matters:</strong> Exposing all 50+ tools when an agent only needs 5 vastly increases the blast radius of compromise.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>Overall Scoring</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>Maximum Score:</strong> 100 points</li>
<li><strong>Per-Server Score:</strong> Weighted average of category scores</li>
<li><strong>Cluster Score:</strong> Weighted average of all per-server scores</li>
<li><strong>Grade Scale:</strong>
<ul>
<li><strong>A (90‚Äì100):</strong> Enterprise-grade security</li>
<li><strong>B (80‚Äì89):</strong> Good security posture</li>
<li><strong>C (70‚Äì79):</strong> Adequate controls, needs improvement</li>
<li><strong>D (60‚Äì69):</strong> Significant gaps</li>
<li><strong>F (&lt;60):</strong> Critical security issues</li>
</ul>
</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Verified Catalog Scoring</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Beyond MCP server evaluation, MCP-G includes <strong>Verified Catalog Scoring</strong> ‚Äî a framework for evaluating MCP server catalog entries from your Agent Registry.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>What It Evaluates</h3>
<!-- /wp:heading -->

<!-- wp:table -->
<table>
<thead>
<tr>
<th>Category</th>
<th>Max Points</th>
<th>What's Checked</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Publisher Verification</strong></td>
<td>25</td>
<td>Organization identity, signing certificates, credibility</td>
</tr>
<tr>
<td><strong>Transport Security</strong></td>
<td>20</td>
<td>TLS support, secure URLs, protocol compliance</td>
</tr>
<tr>
<td><strong>Deployment Health</strong></td>
<td>20</td>
<td>Published status, readiness state, management type</td>
</tr>
<tr>
<td><strong>Tool Scope</strong></td>
<td>18</td>
<td>Tool count compliance, exposure restrictions</td>
</tr>
<tr>
<td><strong>Usage &amp; Integration</strong></td>
<td>17</td>
<td>Agent usage patterns, integration diversity</td>
</tr>
</tbody>
</table>
<!-- /wp:table -->

<!-- wp:heading {"level":2} -->
<h2>Key Features</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>üîç Comprehensive Discovery</strong> - Automatically discovers all MCP-related resources and monitors 9 resource types with real-time updates every 30 seconds</li>
<li><strong>üìä MCP-Server-Centric View</strong> - Correlates resources into per-server security profiles with gateway routes, policies, and tool restrictions</li>
<li><strong>üéØ 8-Category Scoring System</strong> - Evaluates Gateway routing, Authentication, Authorization, TLS, CORS, Rate limiting, Prompt guard, and Tool scope with weighted aggregation</li>
<li><strong>üß† AI-Powered Risk Analysis</strong> - Optional integration with Google Gemini or local Ollama for deeper risk assessment and actionable suggestions</li>
<li><strong>üìã Verified Catalog Scoring</strong> - 5-category assessment of MCP server catalog entries with automated compliance checking</li>
<li><strong>üñ•Ô∏è Real-Time Dashboard</strong> - Next.js-based UI with 6 tabs, per-server drill-down, tool exposure metrics, and auto-refresh every 15 seconds</li>
<li><strong>‚úçÔ∏è Policy-as-Code</strong> - <code>MCPGovernancePolicy</code> Kubernetes CRD for declarative governance with CEL-based expressions</li>
<li><strong>üìà Comprehensive Findings</strong> - Critical to Low severity classifications with per-check status and remediation guidance</li>
<li><strong>üîå REST API</strong> - Complete endpoints for overview, MCP servers, findings, and verified catalog with JSON response format</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Prerequisites</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Required</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>Kubernetes Cluster (1.24+)</strong> - Kind, EKS, GKE, AKS, or any CNCF-certified Kubernetes with cluster admin access and minimum 2 CPU cores, 2GB RAM</li>
<li><strong>kubectl (1.24+)</strong> - Configured to access your cluster</li>
<li><strong>Helm 3 (3.13+)</strong> - For deploying MCP-G via Helm chart</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>Optional but Recommended</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>AgentGateway (latest)</strong> - For MCP server routing and policy enforcement</li>
<li><strong>Kagent (latest)</strong> - For agent and MCPServer resources</li>
<li><strong>Agent Registry (latest)</strong> - For MCPServerCatalog resources</li>
<li><strong>LLM Provider</strong> - Google Cloud Account with Gemini API or local Ollama</li>
<li><strong>DNS (optional)</strong> - For accessing dashboard via domain name with Gateway API route</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Installation Guide</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Step 1: Add the MCP-G Helm Repository</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>helm repo add mcp-governance https://charts.techwithhuz.dev
helm repo update</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 2: Create Namespace</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>kubectl create namespace mcp-governance</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 3: Create AI Configuration Secret (Optional)</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>If using Google Gemini:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre>kubectl create secret generic gemini-config \
  --from-literal=api-key=YOUR_GEMINI_API_KEY \
  -n mcp-governance</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>If using Ollama:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre>kubectl create secret generic ollama-config \
  --from-literal=endpoint=http://ollama:11434 \
  -n mcp-governance</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 4: Deploy with Helm</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Quick Start (Development):</strong></p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre>helm install mcp-governance mcp-governance/mcp-governance \
  -n mcp-governance \
  --set environment=dev</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p><strong>Production Deployment:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre>helm install mcp-governance mcp-governance/mcp-governance \
  -n mcp-governance \
  --set environment=prod \
  --set controller.replicas=3 \
  --set dashboard.replicas=2 \
  --set ai.provider=gemini \
  --set ai.gemini.secretName=gemini-config</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 5: Verify Deployment</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre># Check if pods are running
kubectl get pods -n mcp-governance

# Check logs
kubectl logs -n mcp-governance deployment/mcp-governance-controller -f

# Access dashboard
kubectl port-forward -n mcp-governance svc/mcp-governance-dashboard 3000:3000

# Then open http://localhost:3000</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 6: Create a Governance Policy</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>cat &lt;&lt;EOF | kubectl apply -f -
apiVersion: governance.mcp.io/v1alpha1
kind: MCPGovernancePolicy
metadata:
  name: enterprise-policy
  namespace: default
spec:
  enabled: true
  weights:
    gatewayRouting: 20
    authentication: 20
    authorization: 15
    tlsEncryption: 15
    cors: 10
    rateLimit: 10
    promptGuard: 10
    toolScope: 10
  thresholds:
    minScoreForPassing: 70
    criticalGatewayRequired: true
    tlsRequired: true
  aiScoring:
    enabled: true
    provider: gemini
    cacheResults: true
  verifiedCatalogScoring:
    enabled: true
    weights:
      security: 50
      trust: 30
      compliance: 20
EOF</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Step 7: Verify Governance Policy</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>kubectl get mcpgovernancepolicies
kubectl describe mcpgovernancepolicies enterprise-policy
kubectl get governanceevaluations -w</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":2} -->
<h2>Dashboard Overview</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Once deployed, access the dashboard at <code>http://localhost:3000</code> (or your configured domain).</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>üìä Overview Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>Cluster Score</strong> - Weighted average of all MCP server scores</li>
<li><strong>Grade</strong> - A‚ÄìF letter grade</li>
<li><strong>MCP Servers</strong> - Count of discovered servers</li>
<li><strong>Average Server Score</strong> - Aggregate security posture</li>
<li><strong>Critical Findings</strong> - Count of critical-severity issues</li>
<li><strong>Score Trend</strong> - 7-day trend visualization</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>üîß MCP Servers Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Table view of all discovered MCP servers with color-coded status</li>
<li>Details: namespace, gateway routes, authentication method</li>
<li>Expandable drill-down: Full scoring breakdown, tools exposed, connected agents</li>
<li>Filter and sort by score, namespace, status</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>‚úì Verified Catalog Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>List of MCPServerCatalog resources with score and verification status</li>
<li>Security assessment per governance category</li>
<li>Check results (pass/fail with points)</li>
<li>Expandable details: Findings, tools, agent consumers</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>üì¶ Resource Inventory Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Flat list of all discovered resources</li>
<li>AgentGateway, Kagent, Gateway API, Governance resources</li>
<li>Quick status indicators and resource consumption tracking</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>üö® All Findings Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Complete list of governance findings with severity filtering</li>
<li>Per-server and per-resource organization</li>
<li>Remediation guidance for each finding</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>‚ÑπÔ∏è About MCP-G Tab</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Architecture diagram and prerequisites</li>
<li>Features and scoring system explanation</li>
<li>Kubernetes resources examples</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Configuration: MCPGovernancePolicy CRD</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Example: Basic Policy</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>apiVersion: governance.mcp.io/v1alpha1
kind: MCPGovernancePolicy
metadata:
  name: basic-policy
spec:
  enabled: true
  weights:
    gatewayRouting: 20
    authentication: 20
    authorization: 15
    tlsEncryption: 15
    cors: 10
    rateLimit: 10
    promptGuard: 10
    toolScope: 10</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Example: Strict Policy (Production)</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>apiVersion: governance.mcp.io/v1alpha1
kind: MCPGovernancePolicy
metadata:
  name: strict-policy
spec:
  enabled: true
  weights:
    gatewayRouting: 20
    authentication: 20
    authorization: 15
    tlsEncryption: 15
    cors: 10
    rateLimit: 10
    promptGuard: 10
    toolScope: 10
  thresholds:
    minScoreForPassing: 85
    criticalGatewayRequired: true
    tlsRequired: true
    authenticationRequired: true
    rateLimit:
      enabled: true
      requestsPerSecond: 10</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Example: With AI Scoring</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>apiVersion: governance.mcp.io/v1alpha1
kind: MCPGovernancePolicy
metadata:
  name: ai-policy
spec:
  enabled: true
  aiScoring:
    enabled: true
    provider: gemini
    secretName: gemini-config
    cacheResults: true
    cacheTTL: 3600
    model: "gemini-pro"
  verifiedCatalogScoring:
    enabled: true
    weights:
      security: 50
      trust: 30
      compliance: 20
    thresholds:
      minScoreForVerified: 80</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":2} -->
<h2>API Reference</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Overview Endpoint</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>curl http://localhost:8090/api/governance/overview</pre>
<!-- /wp:preformatted -->

<!-- wp:preformatted -->
<pre>{
  "clusterScore": 82.5,
  "grade": "B",
  "totalMCPServers": 12,
  "averageServerScore": 78.3,
  "criticalFindings": 2,
  "highFindings": 8,
  "scoreTrend": [75, 76, 78, 80, 81, 82, 82.5]
}</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>MCP Servers Endpoint</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>curl http://localhost:8090/api/governance/mcp-servers</pre>
<!-- /wp:preformatted -->

<!-- wp:preformatted -->
<pre>{
  "servers": [
    {
      "name": "grafana-mcp",
      "namespace": "default",
      "score": 85,
      "grade": "B",
      "scores": {
        "gatewayRouting": 20,
        "authentication": 20,
        "authorization": 15,
        "tlsEncryption": 12,
        "cors": 8,
        "rateLimit": 5,
        "promptGuard": 3,
        "toolScope": 2
      },
      "gatewayRoutes": ["grafana-route"],
      "toolsExposed": 12,
      "agentConsumers": ["agent-1", "agent-2"],
      "lastEvaluated": "2025-02-21T10:30:00Z"
    }
  ]
}</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Findings Endpoint</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>curl http://localhost:8090/api/governance/findings</pre>
<!-- /wp:preformatted -->

<!-- wp:preformatted -->
<pre>{
  "findings": [
    {
      "id": "finding-001",
      "server": "grafana-mcp",
      "severity": "High",
      "category": "Authorization",
      "title": "Tool Allow-List Not Configured",
      "description": "No authorization policy restricts tool access",
      "remediation": "Attach AgentgatewayPolicy with tool allow-list",
      "pointsLost": 15
    }
  ]
}</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3>Verified Catalog Endpoint</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre>curl http://localhost:8090/api/governance/inventory/verified</pre>
<!-- /wp:preformatted -->

<!-- wp:preformatted -->
<pre>{
  "resources": [
    {
      "name": "grafana-mcp",
      "namespace": "default",
      "verifiedScore": {
        "score": 85,
        "grade": "B",
        "status": "Verified",
        "securityScore": 90,
        "trustScore": 75,
        "complianceScore": 85
      }
    }
  ]
}</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":2} -->
<h2>Use Cases</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>1. Enterprise Security Compliance</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Ensure all MCP servers meet compliance standards (SOC 2, ISO 27001, etc.) with automated scoring and audit trails.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>2. Multi-Tenant Isolation</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Validate that each tenant's MCP servers are properly isolated with gateway routing and RBAC policies.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>3. AI Agent Risk Assessment</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Before deploying a new AI agent to production, evaluate which MCP servers it can access and their security posture.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>4. Incident Response</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>When a security incident occurs, quickly identify which agents accessed which tools via the findings tab and audit logs.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>5. Continuous Governance</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Maintain security posture as new MCP servers are deployed ‚Äî automatic discovery and evaluation prevent configuration drift.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>6. Vendor Risk Management</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Evaluate third-party MCP server catalogs before integrating them ‚Äî Verified Catalog scoring ensures only trustworthy sources are used.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2>Troubleshooting</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Controller Not Discovering Resources</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Symptom:</strong> Dashboard shows 0 MCP servers found</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Solution:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol>
<li>Check controller logs: <code>kubectl logs deployment/mcp-governance-controller -f</code></li>
<li>Verify Kubernetes API connectivity: <code>kubectl auth can-i list mcpservers --as=system:serviceaccount:mcp-governance:controller</code></li>
<li>Ensure Kagent, AgentGateway, and Governance CRDs are installed</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>Dashboard Not Updating</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Symptom:</strong> Dashboard shows stale data</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Solution:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol>
<li>Check dashboard logs: <code>kubectl logs deployment/mcp-governance-dashboard -f</code></li>
<li>Verify API endpoint is reachable: <code>curl http://localhost:8090/api/governance/overview</code></li>
<li>Check browser console for network errors</li>
<li>Refresh browser and check API polling (Network tab)</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>AI Scoring Errors</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Symptom:</strong> "Failed to score with AI agent" errors</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Solution:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol>
<li>Verify secret is created: <code>kubectl get secret gemini-config -n mcp-governance</code></li>
<li>Test API key with Gemini API endpoint</li>
<li>Check controller logs for LLM errors</li>
<li>Disable AI scoring temporarily: Set <code>aiScoring.enabled: false</code> in policy</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Best Practices</h2>
<!-- /wp:heading -->

<!-- wp:list {"ordered":true} -->
<ol>
<li><strong>Start with Discovery</strong> - Deploy MCP-G first to discover current MCP infrastructure without enforcing policies</li>
<li><strong>Establish Baseline</strong> - Review initial findings and scoring to understand current security posture</li>
<li><strong>Gradual Hardening</strong> - Incrementally increase policy strictness over 5 weeks (discovery ‚Üí soft enforcement ‚Üí gateway ‚Üí auth ‚Üí TLS)</li>
<li><strong>Regular Policy Reviews</strong> - Review MCPGovernancePolicy quarterly to align with evolving security needs</li>
<li><strong>Use AI for Risk Analysis</strong> - Enable AI scoring for deeper insights beyond algorithmic scoring</li>
<li><strong>Monitor Trends</strong> - Watch score trends over time to identify security gaps or improvements</li>
<li><strong>Automate Remediation</strong> - Integrate findings with incident management systems for automated workflows</li>
<li><strong>Document Exceptions</strong> - When servers can't meet requirements, document the exception and remediation timeline</li>
</ol>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Roadmap</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>Current (v0.17.0)</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>‚úÖ 9 resource type discovery</li>
<li>‚úÖ 8-category scoring system</li>
<li>‚úÖ AI-powered risk analysis (Gemini + Ollama)</li>
<li>‚úÖ Verified catalog scoring</li>
<li>‚úÖ REST API endpoints</li>
<li>‚úÖ Real-time dashboard with 6 tabs</li>
<li>‚úÖ MCPGovernancePolicy CRD</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3>Upcoming (v1.0.0)</h3>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>üîÑ Soft policy enforcement (warnings ‚Üí errors)</li>
<li>üîÑ Automated remediation suggestions with one-click apply</li>
<li>üîÑ Compliance reports (SOC 2, ISO 27001, PCI-DSS)</li>
<li>üîÑ Audit logging and forensics</li>
<li>üîÑ Multi-cluster governance federation</li>
<li>üîÑ Custom scoring extensions (plugins)</li>
<li>üîÑ Webhook-based event notifications</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Conclusion</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>MCP Governance brings enterprise-grade security to Model Context Protocol infrastructure in Kubernetes. By combining automated discovery, multi-category scoring, and optional AI-powered risk analysis, MCP-G gives you visibility and control over your MCP ecosystem.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Whether you're running a few MCP servers or managing a multi-tenant infrastructure, MCP-G helps you:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul>
<li>Discover and inventory all MCP resources</li>
<li>Evaluate security posture across 8 categories</li>
<li>Identify and remediate vulnerabilities</li>
<li>Maintain continuous compliance</li>
<li>Scale governance with your organization</li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Get started today:</strong></p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol>
<li>Clone the repository: <code>git clone https://github.com/techwithhuz/mcp-security-governance</code></li>
<li>Deploy to your cluster: <code>helm install mcp-governance ./charts/mcp-governance</code></li>
<li>Access the dashboard and review your MCP security posture</li>
</ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>For questions, issues, or contributions, visit <a href="https://github.com/techwithhuz/mcp-security-governance">GitHub</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2>Additional Resources</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li><strong>GitHub Repository:</strong> <a href="https://github.com/techwithhuz/mcp-security-governance">techwithhuz/mcp-security-governance</a></li>
<li><strong>Helm Chart:</strong> <code>charts/mcp-governance</code></li>
<li><strong>CRD Documentation:</strong> <code>charts/mcp-governance/crds/</code></li>
<li><strong>API Documentation:</strong> See API Reference section above</li>
<li><strong>AgentGateway:</strong> <a href="https://agentgateway.dev">agentgateway.dev</a></li>
<li><strong>Kagent:</strong> <a href="https://kagent.dev">kagent.dev</a></li>
<li><strong>Model Context Protocol:</strong> <a href="https://modelcontextprotocol.io">modelcontextprotocol.io</a></li>
</ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Author:</strong> Tech With Huz<br><strong>Last Updated:</strong> February 2025<br><strong>License:</strong> MIT</p>
<!-- /wp:paragraph -->
